<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zahid Asghar, School of Economics, Quaid-i-Azam University, Islamabad, Pakistan">

<title>Unlocking the Power of Data: Enhancing Public Policy through Advanced Data Infrastructure and Language Model Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="iba_paper_files/libs/clipboard/clipboard.min.js"></script>
<script src="iba_paper_files/libs/quarto-html/quarto.js"></script>
<script src="iba_paper_files/libs/quarto-html/popper.min.js"></script>
<script src="iba_paper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="iba_paper_files/libs/quarto-html/anchor.min.js"></script>
<link href="iba_paper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="iba_paper_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="iba_paper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="iba_paper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="iba_paper_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Unlocking the Power of Data: Enhancing Public Policy through Advanced Data Infrastructure and Language Model Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zahid Asghar, School of Economics, Quaid-i-Azam University, Islamabad, Pakistan </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="abstract" class="level1">
<h1>Abstract</h1>
<p>Data is the fundamental building block for advancements in artificial intelligence (AI), general AI (GAI), machine learning (ML), and large language models (LLMs). This study emphasizes the critical need for robust data infrastructure, arguing that without it, countries cannot fully benefit from technological advancements in various economic sectors. Governments possess vast repositories of both structured and unstructured data across multiple domains such as the judiciary, parliaments, and civil bureaucracy. However, these potential goldmines remain largely untapped due to inadequate data management capabilities and a lack of appreciation for the necessity of high-quality data. The research identifies key issues in public data management, including the non-uniform representation of key data sets and the prevalence of non-machine-readable formats, which further complicates data utilization. By analyzing examples of inconsistencies in standard data conventions within public datasets, this study underscores the challenges posed by messy data, which requires specific skills to be transformed into a tidy format where each feature is clearly delineated and consistently formatted.</p>
<p>The objectives of this research are twofold: to explore effective utilization of public policy data and to harness natural language processing (NLP) and LLMs to analyze critical policy documents, such as monetary policy statements issued by the State Bank of Pakistan. This study aims to demonstrate how enormous amounts of unstructured policy document data can be leveraged to analyze policy objectives, enhance public policy formulation and implementation, thereby realizing the potential of data as a strategic asset in governance.</p>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction"><strong>1. Introduction</strong></h3>
<ul>
<li><strong>1.1 Background and Motivation</strong></li>
</ul>
<p>Data is the backbone of AI, GAI, ML, and LLMs, playing a critical role in the advancement of these technologies. However, the public sector’s data infrastructure in a country like Pakistan is often inadequate, hindering the realization of the full potential of these technologies. Tools like NLP and LLMs can be leveraged to analyze policy documents and enhance public policy formulation and implementation. But the challenges posed by non-uniform data representation and non-machine-readable formats need to be addressed to unlock the power of data in governance. Moreover, 80% of data are unstructured, and the public sector holds a significant portion of this data. By effectively utilizing this data, governments can make informed decisions and improve public services. Nevertheless, the lack of appreciation for the importance of high-quality data and the absence of robust data management practices pose significant challenges to leveraging this data effectively.</p>
<p>The timeline illustrates how the sources of national competitive advantage have evolved across different eras, highlighting the shifting factors that have defined global power dynamics. Historically, civilizations gained dominance based on their unique strengths, ranging from culture and military prowess to technological advancements. For example, Ancient India was known for its profound knowledge and cultural richness, which set it apart as a center of learning and philosophy. Similarly, the Roman Empire’s organized legions and catapults were key to its expansion and control across vast territories, demonstrating how strategic military capabilities can establish a dominant position.</p>
<p>As we progress through the timeline, the Mongol Empire leveraged its horse archers and trade network, while the Ottoman Empire’s advantage lay in heavy artillery and cannons. The British Empire’s power was marked by its colonization strategy, backed by gunpowder and a formidable naval fleet. Moving into the 20th century, the United States emerged as a global leader through its combination of economic strength and military power. Today, as we look to the future, the trend indicates that the next global superpower will be defined by its command over data. This suggests that nations capable of harnessing, analyzing, and leveraging data effectively will gain a competitive edge, signifying a shift from traditional military and economic power to digital and information dominance.</p>
<p>Here is a draft of a research paper based on the content from the presentation:</p>
<hr>
<p><strong>Title: Data as the New Currency: Challenges and Opportunities in the 4th Industrial Revolution</strong></p>
<p><strong>Abstract:</strong><br>
The 4th Industrial Revolution is characterized by the proliferation of data and digital technologies, which have transformed the global economy. Data has become a strategic asset, often described as the “new currency” that drives progress and innovation. However, many countries, including Pakistan, face significant challenges in capitalizing on this digital abundance due to limited capacity and infrastructure. This paper explores the paradox of data abundance versus utilization, examines the barriers to effective data monetization, and highlights strategies for fostering data empowerment through collaboration among academia, government, and industry. It concludes by emphasizing the need for enhanced data quality, privacy, and trust to unlock the potential of data-driven solutions.</p>
<p><strong>1. Introduction</strong><br>
The digital age has ushered in an era where data is an essential driver of economic growth and technological innovation. The 4th Industrial Revolution is built on the foundation of data, artificial intelligence (AI), and advanced analytics, which are reshaping traditional industries and creating new opportunities. Despite the potential, many developing countries, including Pakistan, struggle to harness the full power of data due to gaps in digital readiness, infrastructure, and policy frameworks. This paper discusses the concept of data as a currency, outlines the challenges associated with data utilization, and presents strategies for overcoming these obstacles.</p>
<p><strong>2. The Era of Digital Abundance</strong><br>
Data is often referred to as the “fuel of progress” in the digital economy. The availability of vast amounts of data has made it possible for organizations to drive innovation, enhance productivity, and improve decision-making. However, there exists a considerable gap between data generation and effective data usage. According to the AI Readiness Index, Pakistan ranks 117th out of 174 countries, highlighting the need for improvements in digital infrastructure, human capital, and governance to compete in the global data economy.</p>
<p><strong>3. The Data Paradox</strong><br>
The central theme of this paper is the “Data Paradox,” which refers to the contrast between the overwhelming quantity of data generated (data deluge) and the limited capacity to process, analyze, and extract value from it (capacity drought). While data has become a ubiquitous resource, many organizations and governments are ill-equipped to manage it effectively. This paradox leads to missed opportunities for economic growth and development, particularly in sectors that could benefit from data-driven insights.</p>
<p><strong>4. Monetizing Data - Creating Value</strong><br>
Effective data monetization involves transforming raw data into valuable insights that can drive economic and social progress. However, this requires robust data management systems, skilled data professionals, and supportive regulatory frameworks. In Pakistan, the untapped potential of data is akin to unexplored natural resources. To create value from data, it is essential to invest in digital skills development, data infrastructure, and analytics capabilities. Furthermore, fostering a culture of innovation and entrepreneurship around data can lead to the emergence of new industries and services.</p>
<p><strong>5. The Role of Data Quality</strong><br>
Data quality is fundamental to the success of any data-driven initiative. High-quality, accurate, and reliable data serves as the foundation for effective policy analysis, economic planning, and AI applications. Poor data quality can lead to erroneous conclusions, inefficient resource allocation, and suboptimal policy outcomes. Therefore, establishing data quality standards, along with proper data governance mechanisms, is crucial for building a robust data ecosystem. This paper emphasizes the importance of local, context-specific data that can inform targeted policy interventions.</p>
<p><strong>6. Data Privacy and Building Trust</strong><br>
The issue of data privacy is a significant concern in the digital age. Protecting the privacy and security of data is essential for building trust among citizens, businesses, and government entities. Governments must ensure that data is collected, stored, and processed in a secure manner, while also being accessible and easy to work with. Transparency in data practices can help build public confidence and encourage collaboration across sectors. The paper discusses the importance of timely data provision, machine-readable formats, and clear data usage policies as foundational elements of trust in the digital economy.</p>
<p><strong>7. Enhancing Data Empowerment through Collaboration</strong><br>
Addressing the challenges associated with data requires a collaborative approach that involves academia, government, and the private sector. Collaborative efforts can lead to the development of local expertise, the sharing of knowledge, and the creation of innovative solutions tailored to the needs of the local economy. For example, initiatives such as the Quarterly National Accounts (QNA) App, developed by Yaseen and Zahid, demonstrate how localized data solutions can assist policymakers and researchers in making informed decisions. Similarly, the Monetary Policy Simulator (MPS) portal, available at <a href="https://zahidasghar.com/mps/mpspk">https://zahidasghar.com/mps/mpspk</a>, provides a practical example of how data-driven tools can support economic planning and analysis.</p>
<p><strong>8. Conclusions and Policy Implications</strong><br>
The 4th Industrial Revolution presents both opportunities and challenges for countries like Pakistan. While data has the potential to drive economic growth and innovation, realizing this potential requires addressing the existing barriers to data utilization. This paper concludes by highlighting key policy implications: - <strong>Investment in Digital Infrastructure:</strong> Strengthening digital infrastructure and expanding access to digital technologies are essential for enabling data-driven innovation. - <strong>Capacity Building and Skill Development:</strong> Developing a skilled workforce capable of managing and analyzing data is critical for economic competitiveness. - <strong>Enhancing Data Governance:</strong> Establishing clear regulations around data privacy, quality, and sharing can foster trust and facilitate collaboration across sectors. - <strong>Promoting Public-Private Partnerships:</strong> Encouraging partnerships between academia, industry, and government can lead to the development of innovative solutions and the effective use of data for economic and social progress.</p>
<p><strong>9. Future Research Directions</strong><br>
Future research should focus on exploring the specific barriers to data utilization in developing countries and identifying strategies to overcome them. Additionally, studies on the impact of data-driven technologies on economic sectors, such as agriculture, healthcare, and finance, can provide valuable insights into how data can be leveraged to address local challenges.</p>
<p><strong>References</strong><br>
- AI Readiness Index 2024. (2024). Retrieved from [insert URL]. - Zahid, A., &amp; Yaseen, M. (2024). Quarterly National Accounts (QNA) App. Retrieved from <a href="https://posit.cloud/content/9015591">https://posit.cloud/content/9015591</a>. - Asghar, Z. (2024). Monetary Policy Simulator (MPS). Retrieved from <a href="https://zahidasghar.com/mps/mpspk">https://zahidasghar.com/mps/mpspk</a>.</p>
<ol type="1">
<li><p><strong>The Urgency of Integrating Data Analytics in Policy Formulation and Execution</strong>: In today’s fast-paced, data-rich environment, policymakers must make informed, evidence-based decisions that can rapidly adapt to changing conditions. Integrating data analytics into policy formulation and execution enables governments and institutions to analyze trends, identify emerging issues, and predict outcomes. This data-driven approach helps ensure that policies are not only reactive but also proactive, allowing for more targeted and efficient solutions to societal problems. Moreover, real-time data analysis can aid in monitoring the implementation of policies, helping to adjust strategies on the go for better outcomes.</p></li>
<li><p><strong>The Importance of Both Structured and Unstructured Data</strong>: Effective data analysis requires the consideration of both structured and unstructured data. Structured data, such as numbers and dates stored in traditional databases, can provide clear and concise insights that are easy to analyze and interpret. However, unstructured data, including text, images, videos, and social media content, adds depth and context that structured data alone cannot offer. The integration of both data types enables a more comprehensive understanding of issues, allowing policymakers to address the nuances and complexities of real-world scenarios. Harnessing the power of unstructured data can reveal trends and sentiments that might otherwise be overlooked.</p></li>
<li><p><strong>The Necessity of Investing in Data Infrastructure and Capacity Building</strong>: Developing an advanced data infrastructure and building capacity are essential for leveraging data analytics in governance. Robust data systems ensure secure, scalable, and efficient data collection, storage, and processing. Without the appropriate infrastructure, data analytics efforts can be hampered by issues like data silos, slow processing times, and limited accessibility. Alongside infrastructure, investing in capacity building is crucial to ensure that policymakers and analysts have the necessary skills to interpret and apply data insights effectively. This combination lays the foundation for a data-centric approach that can drive more informed, timely, and impactful policy decisions.</p></li>
<li><p><strong>The Role of Data Analytics in Augmenting, Not Replacing, Expert Opinions</strong>: While data analytics can provide invaluable insights, it should serve as a complement to, rather than a replacement for, expert opinions. Experts bring domain knowledge, contextual understanding, and critical thinking that are essential for interpreting data within the broader social, economic, and political landscape. Data analytics can augment this expertise by uncovering patterns and correlations that might not be immediately apparent, but final decisions should always be guided by a blend of data insights and human judgment. This collaborative approach ensures that policies are both data-driven and contextually relevant.</p></li>
<li><p><strong>Encouraging a Cultural Shift Towards Valuing Data as a Critical Tool for Effective Governance</strong>: For data-driven governance to be successful, there must be a cultural shift that values data as a fundamental asset in decision-making. This involves creating an environment where data is openly shared, transparent, and integrated into the core processes of policy development. Encouraging such a culture requires leadership to advocate for data literacy, openness to adopting new technologies, and a willingness to change traditional approaches. When policymakers, stakeholders, and the general public understand the benefits of data-driven strategies, there is greater buy-in, which facilitates the adoption of more effective, efficient, and transparent governance practices.</p></li>
</ol>
<p>This study aims to explore the untapped potential of government - held structured and unstructured data and the challenges posed by non-uniform data representation and non-machine-readable formats.</p>
<p><strong>1.2 Problem Statement</strong> - Challenges due to inadequate data management and appreciation. - Issues with non-uniform data representation and non-machine-readable formats. - <strong>1.3 Objectives of the Study</strong> - Effective utilization of public policy data. - Leveraging NLP and LLMs for policy document analysis. - <strong>1.4 Significance of the Study</strong> - Enhancing public policy formulation and implementation. - Realizing data as a strategic asset in governance.</p>
</section>
<section id="literature-review" class="level3">
<h3 class="anchored" data-anchor-id="literature-review"><strong>2. Literature Review</strong></h3>
<ul>
<li><strong>2.1 Data as the Backbone of AI and ML</strong>
<ul>
<li>The importance of high-quality data in AI advancements.</li>
</ul></li>
<li><strong>2.2 Data Infrastructure in Governance</strong>
<ul>
<li>Global best practices.</li>
<li>Comparison with the current state in Pakistan.</li>
</ul></li>
<li><strong>2.3 Challenges in Public Data Management</strong>
<ul>
<li>Inconsistencies in data representation.</li>
<li>Prevalence of non-machine-readable formats.</li>
</ul></li>
<li><strong>2.4 Applications of NLP and LLMs in Policy Analysis</strong>
<ul>
<li>Case studies and previous research.</li>
</ul></li>
</ul>
</section>
<section id="methodology" class="level3">
<h3 class="anchored" data-anchor-id="methodology"><strong>3. Methodology</strong></h3>
<ul>
<li><strong>3.1 Data Collection</strong>
<ul>
<li>Sources of public policy documents.</li>
<li>Selection of monetary policy statements from the State Bank of Pakistan.</li>
</ul></li>
<li><strong>3.2 Data Preparation</strong>
<ul>
<li>Addressing messy data and transforming it into a tidy format.</li>
<li>Tools and techniques used for data cleaning.</li>
</ul></li>
<li><strong>3.3 Analytical Framework</strong>
<ul>
<li>Application of NLP techniques.</li>
<li>Utilization of LLMs for text analysis.</li>
</ul></li>
<li><strong>3.4 Limitations</strong>
<ul>
<li>Potential biases.</li>
<li>Technical constraints.</li>
</ul></li>
</ul>
</section>
<section id="analysis-of-monetary-policy-statements" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-monetary-policy-statements"><strong>4. Analysis of Monetary Policy Statements</strong></h3>
<ul>
<li><strong>4.1 Overview of Monetary Policy in Pakistan (Last 20 Years)</strong>
<ul>
<li>Key policy changes and economic contexts.</li>
</ul></li>
<li><strong>4.2 Text Analysis Using NLP and LLMs</strong>
<ul>
<li>Identification of policy objectives.</li>
<li>Trends and patterns over two decades.</li>
</ul></li>
<li><strong>4.3 Interpretation of Results</strong>
<ul>
<li>Insights into policy formulation.</li>
<li>Impact on economic sectors.</li>
</ul></li>
</ul>
</section>
<section id="challenges-identified-in-data-utilization" class="level3">
<h3 class="anchored" data-anchor-id="challenges-identified-in-data-utilization"><strong>5. Challenges Identified in Data Utilization</strong></h3>
<ul>
<li><strong>5.1 Non-Uniform Data Representation</strong>
<ul>
<li>Specific examples and their implications.</li>
</ul></li>
<li><strong>5.2 Non-Machine-Readable Formats</strong>
<ul>
<li>Obstacles in data processing.</li>
</ul></li>
<li><strong>5.3 The Skill Gap in Data Transformation</strong>
<ul>
<li>Necessity for specialized skills.</li>
<li>Recommendations for capacity building.</li>
</ul></li>
</ul>
</section>
<section id="enhancing-data-infrastructure-for-public-policy" class="level3">
<h3 class="anchored" data-anchor-id="enhancing-data-infrastructure-for-public-policy"><strong>6. Enhancing Data Infrastructure for Public Policy</strong></h3>
<ul>
<li><strong>6.1 Recommendations</strong>
<ul>
<li>Standardizing data formats.</li>
<li>Implementing machine-readable data protocols.</li>
</ul></li>
<li><strong>6.2 Leveraging Data for AI and ML</strong>
<ul>
<li>Potential benefits across governance sectors.</li>
</ul></li>
<li><strong>6.3 Role of Stakeholders</strong>
<ul>
<li>Government agencies.</li>
<li>Civil society and private sector collaboration.</li>
</ul></li>
</ul>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion"><strong>7. Conclusion</strong></h3>
<ul>
<li><strong>7.1 Summary of Findings</strong>
<ul>
<li>Recap of key insights from the analysis.</li>
</ul></li>
<li><strong>7.2 Implications for Policy Makers</strong>
<ul>
<li>How improved data infrastructure can enhance policy formulation.</li>
</ul></li>
<li><strong>7.3 Future Research Directions</strong>
<ul>
<li>Areas for further exploration.</li>
</ul></li>
</ul>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references"><strong>8. References</strong></h3>
<ul>
<li>Comprehensive list of sources cited.</li>
</ul>
</section>
<section id="appendices" class="level3">
<h3 class="anchored" data-anchor-id="appendices"><strong>Appendices</strong></h3>
<ul>
<li><strong>A. Detailed Methodological Notes</strong></li>
<li><strong>B. Supplementary Data and Figures</strong></li>
<li><strong>C. Technical Specifications of NLP and LLM Tools Used</strong></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>